{% extends "base.html" %}

{% block title %}{{ module.title }}{% endblock %}

{% block content %}
<style>
    .module-navigation .btn {
        padding: 10px 20px;
        border-radius: 25px;
        color: white;
        text-decoration: none;
        font-weight: bold;
        transition: transform 0.2s;
    }
    .btn-primary {
        background-color: #007bff;
    }
    .btn-secondary {
        background-color: #6c757d;
    }
    .btn-success {
        background-color: #28a745;
    }
    .btn-info {
        background-color: #17a2b8;
    }
    .btn-warning {
        background-color: #ffc107;
    }
    .btn-danger {
        background-color: #dc3545;
    }
    .btn:hover {
        transform: scale(1.05);
    }
    iframe {
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
    }
    iframe::-webkit-scrollbar {
        display: none; /* Chrome, Safari and Opera */
    }
</style>

<div class="module-header" style="text-align: center; margin-bottom: 20px;">
    <h1>{{ module.title }}</h1>
    <button id="playBtn" class="btn btn-info">Ler em Voz Alta üîä</button>
    <button id="pauseBtn" class="btn btn-warning">Pausar ‚è∏</button>
    <button id="resumeBtn" class="btn btn-info">Continuar ‚ñ∂Ô∏è</button>
    <button id="stopBtn" class="btn btn-danger">Parar ‚èπÔ∏è</button>
</div>

<div class="module-content">
    <iframe src="{{ module.iframe_src }}" width="100%" height="600px" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
</div>
<div class="module-navigation" style="text-align: center; margin-top: 20px;">
    {% if module.id > 1 %}
        <a href="{{ url_for('module', module_id=module.id - 1) }}" class="btn btn-secondary">‚ùÆ M√≥dulo Anterior</a>
    {% endif %}
    {% if module.id < modules_data|length %}
        <a href="{{ url_for('module', module_id=module.id + 1) }}" class="btn btn-primary">Pr√≥ximo M√≥dulo ‚ùØ</a>
    {% else %}
        <a href="{{ url_for('congratulations') }}" class="btn btn-success">Finalizar e ver Certificado ‚òÖ</a>
        <a href="{{ url_for('game') }}" class="btn btn-primary" style="margin-left: 10px;">Jogar Agora! üéÆ</a>
    {% endif %}
</div>

<script>
    var utterance = new SpeechSynthesisUtterance();
    var moduleText = {{ module_text|tojson }};

    document.getElementById('playBtn').addEventListener('click', function() {
        utterance.text = moduleText;
        speechSynthesis.cancel(); // Stop any previous speech
        speechSynthesis.speak(utterance);
    });

    document.getElementById('pauseBtn').addEventListener('click', function() {
        speechSynthesis.pause();
    });

    document.getElementById('resumeBtn').addEventListener('click', function() {
        speechSynthesis.resume();
    });

    document.getElementById('stopBtn').addEventListener('click', function() {
        speechSynthesis.cancel();
    });
</script>
{% endblock %}
